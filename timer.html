<!DOCTYPE html>
<html>
<head>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif;
    background-color: transparent; /* Matches Notion Background */
    color: #37352f;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    margin: 0;
  }
  
  /* Dark Mode Support via URL parameter ?theme=dark */
  body.dark { color: rgba(255, 255, 255, 0.9); }

  #timer {
    font-size: 2.5rem;
    font-weight: 700;
    font-variant-numeric: tabular-nums; /* Keeps numbers from jumping */
    margin-bottom: 10px;
  }
  
  .controls { display: flex; gap: 10px; }
  
  button {
    background: #e1e1e1;
    border: none;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    color: #37352f;
    transition: background 0.2s;
  }
  
  button:hover { background: #d0d0d0; }
  button.active { background: #2eaadc; color: white; }
  
  body.dark button { background: #505050; color: white; }
  body.dark button:hover { background: #606060; }
</style>
</head>
<body>

<div id="timer">0d 00:00:00</div>
<div class="controls">
  <button id="startBtn" onclick="toggleTimer()">Start</button>
  <button onclick="resetTimer()">Reset</button>
</div>

<script>
  let startTime;
  let elapsedTime = 0;
  let timerInterval;
  let running = false;

  // Check for dark mode preference in URL (e.g. mywidget.html?theme=dark)
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get('theme') === 'dark') {
    document.body.classList.add('dark');
  }

  function updateDisplay() {
    let time = elapsedTime;
    if (running) {
      time += Date.now() - startTime;
    }

    const seconds = Math.floor((time / 1000) % 60);
    const minutes = Math.floor((time / (1000 * 60)) % 60);
    const hours = Math.floor((time / (1000 * 60 * 60)) % 24);
    const days = Math.floor(time / (1000 * 60 * 60 * 24));

    const f = (num) => num.toString().padStart(2, '0');
    
    document.getElementById("timer").textContent = 
      `${days}d ${f(hours)}:${f(minutes)}:${f(seconds)}`;
  }

  function toggleTimer() {
    const btn = document.getElementById("startBtn");
    if (running) {
      // Pause
      running = false;
      elapsedTime += Date.now() - startTime;
      clearInterval(timerInterval);
      btn.textContent = "Start";
      btn.classList.remove("active");
    } else {
      // Start
      running = true;
      startTime = Date.now();
      timerInterval = setInterval(updateDisplay, 100); // Update every 100ms
      btn.textContent = "Pause";
      btn.classList.add("active");
    }
  }

  function resetTimer() {
    running = false;
    clearInterval(timerInterval);
    elapsedTime = 0;
    updateDisplay();
    document.getElementById("startBtn").textContent = "Start";
    document.getElementById("startBtn").classList.remove("active");
  }
</script>

</body>
</html>
